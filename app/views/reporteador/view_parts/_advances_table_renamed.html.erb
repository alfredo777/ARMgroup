<div class="table-responsive"  style="max-height: 250px; overflow: auto;">
  <% if table.response_code %>
  <% @rcodes = eval(table.response_codes) %>
  <table class="table table-condensed" style="border: #fff;">
    <thead>
      <tr>
        <% agrouped_table(table, hashx)[:heads].each_with_index do |parseh, index| %>
        <% if index > 0 %>
        <% if parseh != "" %>
        <th colspan="3"> <%= name_by_code(parseh, @rcodes) %></th>
        <%else%>
        <th colspan="1">Null</th>
        <%end%>
        <%else%>
        <% if index == 0 %>
        <th colspan="1" ></th>
        <%end%>
        <%end%>
        <%end%>
      </tr>
    </thead>
    <tbody>
      <% agrouped_table(table, hashx)[:data].each do |data| %>
      <tr>
        <% agrouped_table(table, hashx)[:heads].each_with_index do |parseh, index| %>
        <% if parseh != "" %>
        <% if index != 0 %>
        <% if name_by_code(parseh, @rcodes) != nil %>
        <td><%= (data[parseh].to_f * n.to_f).round %> <td/><td> <%= (data[parseh].to_f*100).round(5)%>% </td>
        <%else%>
        <td></td>
        <%end%>
        <%else%>
        <td><%= data[parseh] %></td>
        <%end%>
        <%else%>
        <% if data[parseh] != 1.0 %>
        <td><%= (data[parseh].to_f*100).round(5)%></td>
        <%else%>
        <td></td>
        <%end%>
        <%end%>
        <%end%>
      </tr>
    </tbody>
    <%end%>
  </table>
  <table style="border: #fff; display: none;" id="chart_table_<%=index%>">
    <thead>
      <tr>
        <% agrouped_table(table, hashx)[:heads].each_with_index do |parseh, index| %>
        <% if index > 0 %>
        <% if parseh != "" %>
        <th> <%= name_by_code(parseh, @rcodes) %></th>
        <%else%>
        <th>Null</th>
        <%end%>
        <%else%>
        <th></th>
        <%end%>
        <%end%>
      </tr>
    </thead>
    <tbody>
      <% agrouped_table(table, hashx)[:data].each do |data| %>
      <tr>
        <% agrouped_table(table, hashx)[:heads].each_with_index do |parseh, index| %>
        <% if parseh != "" %>
        <% if index != 0 %>
        <td><%= (data[parseh].to_f*100).round(5)%></td>
        <%else%>
        <td><%= data[parseh] %></td>
        <%end%>
        <%else%>
        <% if data[parseh] != 1.0 %>
        <td><%= (data[parseh].to_f*100).round(5)%></td>
        <%else%>
        <td></td>
        <%end%>
        <%end%>
        <%end%>
      </tr>
    </tbody>
    <%end%>
    
  </table>
  <script>
  $(function () {

    var calculus = $(window).width() * 0.70;
    console.log(calculus);

    window.chart = Highcharts.chart("load_chart_table_<%=index%>", {
        data: {
            table: "chart_table_<%=index%>"
        },
        chart: {
            type: 'column',
            width: calculus
        },
        title: {
            text: 'Extraida de la tabla'
        },
        yAxis: {
            allowDecimals: false,
            title: {
                text: 'Units'
            }
        },
        tooltip: {
            formatter: function () {
                return '<b>' + this.series.name + '</b><br/>' +
                    this.point.y + '% ' + this.point.name.toLowerCase();
            }
        }
    });


  
  });
  </script>
  <%end%>
</div>
